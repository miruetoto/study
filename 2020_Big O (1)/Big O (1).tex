\documentclass[12pt,oneside,english]{book}
\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{color}
\definecolor{marron}{RGB}{60,30,10}
\definecolor{darkblue}{RGB}{0,0,80}
\definecolor{lightblue}{RGB}{80,80,80}
\definecolor{darkgreen}{RGB}{0,80,0}
\definecolor{darkgray}{RGB}{0,80,0}
\definecolor{darkred}{RGB}{80,0,0}
\definecolor{shadecolor}{rgb}{0.97,0.97,0.97}
\usepackage[demo]{graphicx}
\usepackage{wallpaper}
\usepackage{wrapfig,booktabs}

\usepackage{fancyhdr}
\usepackage{lettrine}
\input Acorn.fd

\renewcommand{\familydefault}{pplj} 
\usepackage[
final,
stretch=10,
protrusion=true,
tracking=true,
spacing=on,
kerning=on,
expansion=true]{microtype}

%\setlength{\parskip}{1.5ex plus 0.2ex minus 0.2ex}


\usepackage{fourier-orns}
\newcommand{\dash}{\vspace{2em}\noindent \textcolor{darkgray}{\hrulefill~ \raisebox{-2.5pt}[10pt][10pt]{\leafright \decofourleft \decothreeleft  \aldineright \decotwo \floweroneleft \decoone   \floweroneright \decotwo \aldineleft\decothreeright \decofourright \leafleft} ~  \hrulefill \\ \vspace{2em}}}
\newcommand{\rdash}{\noindent \textcolor{darkgray}{ \raisebox{-1.9pt}[10pt][10pt]{\leafright} \hrulefill \raisebox{-1.9pt}[10pt][10pt]{\leafright \decofourleft \decothreeleft  \aldineright \decotwo \floweroneleft \decoone}}}
% \newcommand{\ldash}{\textcolor{darkgray}{\raisebox{-1.9pt}[10pt][10pt]{\decoone \floweroneright \decotwo \aldineleft \decothreeright \decofourright \leafleft} \hrulefill \raisebox{-1.9pt}[10pt][10pt]{\leafleft}}}

\fancyhf{}

\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{#1}}

\newcommand{\estcab}[1]{\itshape\textcolor{marron}{\nouppercase #1}}

\fancyhead[LO]{\estcab{\rightmark}} 
\fancyhead[RO]{\estcab{\leftmark}}
\fancyhead[RO]{\bf\nouppercase{ \leftmark}}
\fancyfoot[RO]{ \leafNE  ~~ \bf \thepage}

\newenvironment{Section}[1]
{\section{\vspace{0ex}#1}}
{\vspace{12pt}\centering ------- \decofourleft\decofourright ------- \par}

\usepackage{lipsum}
\setlength{\parindent}{1em} % Sangría española
\pagestyle{fancy}

\renewcommand{\footnoterule}{\noindent\textcolor{marron}{\decosix \raisebox{2.9pt}{\line(1,0){100}} \lefthand} \vspace{.5em} }
\usepackage[hang,splitrule]{footmisc}
\addtolength{\footskip}{0.5cm}
\setlength{\footnotemargin}{0.3cm}
\setlength{\footnotesep}{0.4cm} 

\usepackage{chngcntr}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}

\usepackage{kotex}
\usepackage{amsthm} 
\usepackage{amsmath} 
\usepackage{amsfonts}
\usepackage{enumerate} 
\usepackage{cite}
\usepackage{graphics} 
\usepackage{graphicx,lscape} 
\usepackage{subcaption}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{titlesec}
\usepackage{cite, url}
\usepackage{amssymb}

\def\ck{\paragraph{\Large$\bullet$}\Large}
\def\goal{\paragraph{\Large(목표)}\Large}
\def\observe{\paragraph{\Large(관찰)}\Large}
\def\assume{\paragraph{\Large(가정)}\Large}
\def\summary{\paragraph{\Large(요약)}\Large}
\def\EX{\paragraph{\Large(예제)}\Large}
\def\guess{\paragraph{\Large(추측)}\Large}
\def\thus{\paragraph{\Large(결론)}\Large}
\def\prob{\paragraph{\Large(문제)}\Large}
\def\sol{\paragraph{\Large(해결)}\Large}
\def\dfn{\paragraph{\Large(정의)}\Large}
\def\thm{\paragraph{\Large(정리)}\Large}
\def\lem{\paragraph{\Large(레마)}\Large}
\def\promise{\paragraph{\Large(약속)}\Large}
\def\property{\paragraph{\Large(특징)}\Large}
\def\fl{\paragraph{\Large(느낌)}\Large}
\def\memo{\paragraph{\Large(암기)}\Large}
\def\note{\paragraph{\Large\textit{\underline{note:}}}\Large}
\def\ex{\paragraph{\Large\textit{example:}}\Large}


\def\one{\paragraph{\Large(1)}\Large}
\def\two{\paragraph{\Large(2)}\Large}
\def\three{\paragraph{\Large(3)}\Large}
\def\four{\paragraph{\Large(4)}\Large}
\def\five{\paragraph{\Large(5)}\Large}
\def\six{\paragraph{\Large(6)}\Large}
\def\seven{\paragraph{\Large(7)}\Large}
\def\eight{\paragraph{\Large(8)}\Large}
\def\nine{\paragraph{\Large(9)}\Large}
\def\ten{\paragraph{\Large(10)}\Large}

\newcommand{\bld}[1]{\mbox{\boldmath $#1$}}

\DeclareMathOperator*{\argmin}{arg\,min} %\usepackage{amsmath}를 써야지 정의가능함. 
\DeclareMathOperator*{\argmax}{arg\,max} %\usepackage{amsmath}를 써야지 정의가능함. 

\usepackage{titlesec}
\titleformat*{\section}{\huge\bfseries}
\titleformat*{\subsection}{\huge\bfseries}
\titleformat*{\subsubsection}{\huge\bfseries}
\titleformat*{\paragraph}{\huge\bfseries}
\titleformat*{\subparagraph}{\huge\bfseries}


\titleclass{\part}{top}
\titleformat{\part}[display]
  {\normalfont\huge\bfseries}{\centering\partname\ \thepart}{20pt}{\Huge\centering}
\titlespacing*{\part}{0pt}{50pt}{40pt}
\titleclass{\chapter}{straight}
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titlespacing*{\chapter} {0pt}{50pt}{40pt}

\newcommand*\initfamily{\usefont{U}{Acorn}{xl}{n}}
\usepackage[left=10px,right=10px,top=10px,bottom=10px,paperwidth=8in,paperheight=20in]{geometry}

\usepackage{geometry}
\geometry{
tmargin=3cm, 
bmargin=3cm, 
lmargin=1cm, 
rmargin=1cm,
headheight=1.5cm,
headsep=0.8cm,
footskip=0.5cm}
\linespread{1}

\begin{document}


\begin{thebibliography}{9} 
\bibitem{Van2000} Van der Vaart, A. W. (2000). Asymptotic statistics (Vol. 3). Cambridge university press.
\bibitem{Kim2011} 김우철, 수리통계학.
\bibitem{Kim2012} 김우철, 통계이론1 강의노트.
\end{thebibliography}

\subsubsection{Little $o$}

\dfn $\{x_n\}$, $\{r_n\}$은 실수열이라고 하자. 
\begin{align*}
& x_n=o(r_n) \quad as~  n\to \infty \\*
&\Longleftrightarrow x_n/r_n \to 0 \quad as ~ n \to \infty 
\end{align*}

\note $x_n=o(1)$의 의미는 $x_n\to 0$의 의미이다. 

\note $x_n=o(r_n)$의 의미는 $x_n/r_n \to 0$의 의미이다. 

\ex $x_n=1/n$ 이면 $x_n=o(1)$. 

\ex $x_n=1/n^2$ 이면 $x_n=o(1/n)$

\note $x_n=1/n^2$ 일 경우 $x_n=o(1)$, $x_n=o(1/\sqrt{n})$, $x_n=o(1/n\sqrt{n})$도 가능함. 

\ex $x_n=n^2$이면 $x_n=o(n^3)$. 

\fl $x_n=o(\bigstar_n)$ 의 표현은 $x_n$이 $\bigstar_n$ 보다 빠르게 $0$으로 수렴 (혹은 천천히 $\infty$ 로 발산) 하기만 하면 된다. 

\rdash

\dfn $f(x)$, $g(x)$는 실변수 함수 
\begin{align*}
& f(x)=o\big(g(x)\big) \quad as~  x\to a \\
&\Longleftrightarrow f(x)/g(x) \to 0 \quad as ~ x \to a
\end{align*}

\fl 함수열의 경우도 동일하게 해석할 수 있다. 
\[
f(x)=o\big(\bigstar(x)\big) \quad ~ x \to a
\]
는 $x$가 점점 $a$로 가까워질때 $f(x)$가 $\bigstar(x)$보다 빠르게 $0$으로 수렴하거나 천천히 $\infty$로 발산하면 된다. 

\dash

\subsubsection{Big $O$}

\dfn $\{x_n\}$, $\{r_n\}$은 실수열이라고 하자. 
\begin{align*}
& x_n=O(r_n) \quad as~  n\to \infty \\
&\Longleftrightarrow \sup_n |x_n/r_n| < \infty 
\end{align*}

\ex $x_n=n^2+2n+100$ 이면 $x_n=O(n^2)$.

\ex $x_n=n^{-2}+n^{-1}+1$ 이면 $x_n=O(1)$.

\fl 따라서 
\[
x_n=O(\bigstar_n)
\]
$\{x_n\}$의 최고차항이 $\bigstar_n$의 최고차항과 같다는 의미이다. 

\rdash 

\dfn $f(x)$, $g(x)$는 실변수함수 라고 하자. 
\begin{align*}
& f(x)=O\big(g(x)\big) \quad as~  x\to a \\
&\Longleftrightarrow f(x)/g(x) \to 0 \quad as ~ x \to a
\end{align*}

\dash

\subsubsection{Little $o_p$}
\dfn $\{X_n\}$, $\{R_n\}$은 확률변수열이라고 하자. 
\begin{align*}
& X_n=o_p(R_n) \quad as ~ n\to \infty \\ 
& \Longleftrightarrow X_n/R_n \overset{p}{\to} 0 \quad as ~ n\to \infty 
\end{align*}

\note $X_n=o_p(R_n)$의 의미는 새로운 확률변수 $Y_n=X_n/R_n$의 수열이 $\{Y_n\}$이 $0$으로 확률수렴한다는 의미이다. 

\note 여기에서 $\{R_n\}$ 은 확률변수열이 아니라 실수열로 생각할 수 있다. (실수는 확률변수의 한 종류이므로)

\note $\{X_n\}$ 과 $\{R_n\}$ 이 모두 실수열이라면 $O_p$의 정의가 $O$의 정의와 같아진다. 

\dash

\subsubsection{Big $O_p$}
\dfn $\{X_n\}$, $\{R_n\}$은 확률변수열이라고 하자. 
\begin{align*}
& X_n=O_p(R_n) \quad as ~ n\to \infty \\ 
& \Longleftrightarrow \sup_{n}P\{|X_n/R_n|>M\} \underset{M\to\infty}{\to} 0
\end{align*}

\ck 이게 원래 실수버전으로 생각하면 엄청 큰 $M$에 대해서 
\[
\sup_{n}|X_n / R_n| < M < \infty
\]
이어야 한다. 그런데 $X_n/R_n$은 확률변수이므로 위의 부등식이 성립하지 않게 된다. 결국 $M$을 엄청 크게 잡으면 
\[
\sup_{n}|X_n / R_n| > M 
\]
이 될 확률은 너무 작지않겠냐? 라는 식의 논의를 해야한다. 즉 아래의 느낌이 되어야 한다. 
\[
\mbox{for very large $M$}:\quad P\{\sup_{n}|X_n / R_n| > M \} \approx 0
\]

\ck 이런 느낌을 살린것이 바로 아래의 statement이다. 
\[
P\{\sup_{n}|X_n / R_n| > M \} \underset{M\to\infty}{\to} 0
\]

\fl 결국 $X_n=O_p(1)$의 의미는 
\[
\mbox{for very large $M$}:\quad  P\{\sup_n|X_n| < M \} \approx 1 
\]
의 의미가 된다. 즉 확률변수 $X_n$이 어딘가에 bound 되어 있다는 의미가 된다. 

\thm $Y_n \overset{d}{\to} Y$ 이라면 $Y_n=O_p(1)$ 이다. 

\note 이 정리는 김우철 수리통계학 \cite{Kim2011}  연습문제 5.11, 김우철 통계이론 강의노트 \cite{Kim2012} 의 Review C, 그 외 다수에 소개되어 있다. 

\dfn (\emph{tightness} of $X$) 
\begin{align*}
& \mbox{The random variable $X$ is \emph{tight}} \\
& \overset{def}{\Longleftrightarrow} \forall \epsilon>0 \quad \exists M \quad s.t. \quad P(|X|>M)<\epsilon \\ 
& \overset{def}{\Longleftrightarrow} P(|X|>M) \to 0 \quad as ~ M\to \infty \\ 
& \overset{def}{\Longleftrightarrow} \mu^{\star}\big([-M,M]^c\big) \to 0 \quad as ~ M \to \infty \\ 
& \overset{def}{\Longleftrightarrow} \epsilon>0 \quad \exists M \quad s.t. \quad 1-F(M)+F(-M) < \epsilon 
\end{align*}

\note $\mu^{\star}\big([0,M)\big)=F(M)=P(X<M)$

\note $\mu^{\star}\big([-M,M]^c\big)=1-\big(P(X<M)-P(X<-M)\big)=1-F(M)+F(-M)$
\note 아무리 $\epsilon$을 작게 잡아도 결국 $M$을 크게 잡으면 된다. 

\note 따라서 대충 $M \approx \infty$ 일때 $P(|X|>M) \approx 0$ 인 느낌이다. 

\thm 모든 확률변수 $X$는 \emph{tight} 하다.
 
\dfn (\emph{uniformly tightness} of $\{X_n\}$) 
\begin{align*}
& \mbox{$\{X_n\}$ is \emph{uniformly tight}} \\
& \overset{def}{\Longleftrightarrow} \forall \epsilon>0 \quad \exists M \quad s.t. \quad \sup_nP(|X_n|>M)<\epsilon \\ 
& \overset{def}{\Longleftrightarrow} \sup_n P(|X_n|>M) \to 0 \quad as ~ M\to \infty \\ 
& \overset{def}{\Longleftrightarrow} \sup_n\mu_n^{\star}\big([-M,M]^c\big) \to 0 \quad as ~ M \to \infty \\ 
& \overset{def}{\Longleftrightarrow} \epsilon>0 \quad \exists M \quad s.t. \quad \limsup_{n\to\infty} \big(1-F_n(M)+F_n(-M)\big) < \epsilon \\ 
& \overset{def}{\Longleftrightarrow} X_n=O_p(1) \quad as ~ n\to\infty 
\end{align*}

\ck 결국 확률변수열이 $\{X_n\}$이 $\emph{uniformly tight}$ 하다는 것은 확률적으로 유계라는 말과 같다. (\cite{Van2000} p.8.) 

\note 애초에 \emph{uniformly tightness} 는 $\{X_n\}$ 이 {\it iid} 인 상황에서는 살짝 어색한 개념이다. 왜냐하면 {\it iid} 인 경우라면 하나의 분포 $X_1$만 잡아서 확률적으로 유계임을 보이면 되기 때문이다. 즉 \emph{uniformly} 라는 말을 쓸 필요가 없다. 직관적으로 \emph{uniformly}라는 말을 쓴다는 것은 sup을 취한다는 느낌을 받아야 하는데 \emph{iid} 의 경우
\[
\sup_nP(|X_n|>M)=P(|X_1>M)
\]
이 되어서 sup이 그냥 날아가버린다. 


\subsubsection{Calculus with $O_p$ and $o_p$}

\thm 아래는 증명없이 받아들이자 \cite{Van2000}. 여기에서 $\{R_n\}$은 (아무런 추가조건없는) 확률변수열이다. 
\one $O_p(1)+O_p(1)=O_p(1)$.
\two $o_p(1)+o_p(1)=o_p(1)$.
\three $o_p(1)+O_p(1)=O_p(1)$.
\four $O_p(1)O_p(1)=O_p(1)$.
\five $o_p(1)o_p(1)=o_p(1)$.
\six $O_p(1)o_p(1)=o_p(1)$.
\seven $\big(1+o_p(1)\big)^{-1}=O_p(1)$.
\eight $o_p(R_n)=R_no_p(1)$.
\nine $O_p(R_n)=R_nO_p(1)$.
\ten $o_p\big(O_p(1)\big)=o_p(1)$

\note (2)번 공식, 즉 $o_p(1)+o_p(1)=o_p(1)$ 가 의미하는것은 $X_n \overset{p}{\to} 0$ 이고 $Y_n \overset{p}{\to} 0$ 일때 $Z_n=X_n+Y_n \overset{p}{\to} 0$ 라는 의미이다. 이는 continuous mapping thm 즉 김우철 정리 5.2.3 \cite{Kim2011}의 한 형태가 된다. 

\note (6)번 공식, 즉 $O_p(1)o_p(1)=o_p(1)$ 이 의미하는 것은 (1) $\{X_n\}$ 이 확률적으로 유계이고 (2) $\{Y_n\}$ 이 0으로 확률수렴한다면 ($\bigstar$) $\{X_nY_n\}$ 은 $0$ 으로 확률수렴한다는 의미이다. 여기에서 (1) 대신에 $\{X_n\}$이 어떠한 분포로 분포수렴한다는 가정이 추가적으로 있다면 이는 슬러츠키 정리의 한 형태가 된다. 

\subsubsection{Delta method}

\thm $\{X_n\}$ 이 확률변수열이라고 하자. 
(1) $\sqrt{n}(X_n-\theta) \overset{d}{\to} Z$ 이고 (2) $g(x)$가 $\theta$에서 미분가능하다면 아래가 성립한다. 
\[
\sqrt{n}\big(g(X_n)-g(\theta)) \overset{d}{\to}\dot{g}(\theta)Z
\] 

\note $\{X_n\}$이 \emph{iid} 일 필요는 없다. 

\note 일반적인 함수 $g:\mathbb{R}^k \to \mathbb{R}^{m}$에 대하여 (2)의 조건은 아래와 같이 표현가능하다. \cite{Van2000}
\one $g$ is \emph{differentialbe} at $\theta$ 
\two there is linear map (matrix) $g_{\theta}': \mathbb{R}^k \to \mathbb{R}^{m}$ such that 
\[
g(\theta+h)-g(\theta)=g_{\theta}'(h)+o(\|h\|)
\]
여기에서 linear map $h \to g'_{\theta}(h)$을 \emph{total derivate} 라고 부른다. (이는 \emph{partial derivate}와 구분된다.) 

\note $g(x):\mathbb{R}^{k}\to \mathbb{R}^{m}$이 \emph{totally differentiable} 하기 해서는 (1) $g(x)$의 모든 편미분이 존재하고 즉 모든 $i=1,2,\dots,k$ and $j=1,2,\dots, m$에 대하여 
\[
\frac{\partial g_j(x)}{\partial x_i}
\]
가 존재하고 (2) 그것이 연속이어야 한다. 단순히 편미분이 존재하기만 해서는 안된다. 

\note 위의 조건을 \emph{continuously differentiable} 이라고 하기도 한다. 

\ck 증명을 해보자. 아래가 성립한다. $g(x)$를 $x=a$에서 테일러 전개하면 
\[
g(x) = g(a) + (x-a)\dot{g}(a)+O\big((x-a)^2\big) \quad as ~ x\to a
\]
그런데 $O\big((x-a)^2\big)=(x-a)^2O(1)$ 이므로 
\[
g(x) = g(a) + (x-a)\big(\dot{g}(a)+(x-a)O(1)\big) \quad as ~ x \to a
\]
양변에 $\sqrt{n}$을 곱하면 
\[
\sqrt{n}\big({g(x) -g(a)}\big) = \sqrt{n}(x-a)\big(\dot{g}(a)+(x-a)O(1)\big) \quad as ~ x \to a
\]

\ck $x$대신에 $X_n$을 대입하고 $a$대신에 $\theta$를 대입하면 
\[
\sqrt{n}\big({g(X_n) -g(\theta)}\big) = \sqrt{n}(X_n-\theta)\big(\dot{g}(\theta)+(X_n-\theta)O(1)\big) \quad as ~ X_n \to \theta
\]
정리하면 
\[
\sqrt{n}\big({g(X_n) -g(\theta)}\big) = \sqrt{n}(X_n-\theta)\dot{g}(\theta)+\sqrt{n}(X_n-\theta)^2O(1) \quad as ~ X_n \to \theta
\]

\ck 그런데 조건 (1) 에 따라서 $\sqrt{n}(X_n-\theta)=O_p(1)$이다. 따라서 $X_n-\theta = o_p(1)$이다. 따라서 $\sqrt{n}(X_n-\theta)^2=o_p(1)$이다. 따라서 
\[
\sqrt{n}\big({g(X_n) -g(\theta)}\big) = \sqrt{n}(X_n-\theta)\dot{g}(\theta)+o_p(1)O(1) \quad as ~ X_n \to \theta
\]

\ck $o_p(1)O(1)=o_p(1)$이므로 
\[
\sqrt{n}\big({g(X_n) -g(\theta)}\big) = \sqrt{n}(X_n-\theta)\dot{g}(\theta)+o_p(1) 
\]
따라서 
\[
\sqrt{n}\big({g(X_n) -g(\theta)}\big) \overset{d}{\to} \sqrt{n}(X_n-\theta)\dot{g}(\theta)
\]

\end{document}